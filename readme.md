# <center>键鼠广播说明书|MouseSync</center>

## 📖使用方法 

让被控制端都运行被操纵端`MouseSyncClientCore.exe`

主控端`MouseSyncServer.exe`运行后，鼠标键盘会同步发送到被控端

比如：机房所有学生电脑均运行客户端后，会处于等待操作状态，此时选取一台电脑关闭学生端并打开服务端，就可以开始操控了

## 🗃️文件 
1. 主控端：`MouseSyncServer.exe`	用于把一台计算机的键盘鼠标操作广播出去

2. 被操纵端：`MouseSyncClientCore.exe`	用于机房其他计算机，接收操作者的键盘鼠标动作

3. 配置文件：`Setting.config`			用于指导程序工作，如果没有会自动按提示生成

## ⚠️注意 
<font color=red size=5>**本程序包含模拟鼠标键盘的操作，可能会被杀毒软件误报**</font>

## 🚙用途 

在机房里需要安装某软件，配置某程序时，就可以使用本程序来简化操作
使用时应注意需要电脑分辨率，系统，软件等应完全一致

## 🤩特色 

- 本程序的网络连接采用异步编程，延迟更低，性能更好
- 支持IPv6网络
- 软件小巧，无第三方依赖库，无运行时环境，单程序即可运行

## 🤔已知问题 

不能发送`Ctrl`+`Alt`+`Delete`键，如果按下这三个键，需要退出软件后重新进入，否则`Ctrl`、`Alt`和一些未知键会持续保持被按下状态，直到真正被按下并释放。

## ⚙️配置 

1. 什么都不管，直接运行程序，即可自动配置
2. 也可修改`Setting.config`文件实现手动配置：

<br>

---

<br>

# 🏗️配置设置 `Setting.config`

## ℹ️概念 

|名称|用途|
|:---:|:---|
|Server_IP|记录服务器的IP地址，形如192.168.100.123(注意:IPv6也受支持)|
|Server_Port|用于网络通信的端口(指发送IO数据的通信端口)|
|broadcast_Port|用于网络广播通信的端口，服务端在广播地址上广播本机IPv4地址与端口（支持多网卡），客户端可以通过广播来获取服务器的IP地址|

## 📑配置详情 

|配置名称|默认值|[类型](#类型)|服务端|客户端|
|:---|:---:|:---:|:---|:---|
|Server_IP|无|字符串|无效|要连接的服务器IP地址|
|Server_Port|34757|整数|服务器监听端口|要连接的服务器端口|
|broadcast_Port|34756|整数|广播本机地址与端口|接受广播的端口|
|Mouse_moving_rate|5|整数|详见[鼠标移动发送率](#鼠标移动发送率)|无效|
|Hide_on_start|True|布尔值|是否在程序启动时最小化窗口|同服务端|
|Enable_broadcast|True|布尔值|是否启动广播|是否监听广播(若该值为True，将会忽略配置文件中的服务器地址)|
|Is_retry_instantly|False|布尔值|无效|是否在出现错误后立即重试|
|Is_EnableHot-Key|True|布尔值|详见[暂停与继续](#暂停与继续)|无效|

## 鼠标移动发送率 
当鼠标移动时会产生很多个鼠标移动事件，Mouse_moving_rate值表示要发送的比例

发送的鼠标移动事件的比例为该数的倒数
$\frac{1}{Mouse \underline{ } moving \underline{ } rate}$

这个值不会对点击等其他事件的精准度产生影响

## 暂停与继续  
启用热键(`Shift`+`F8`)暂停与继续发送键鼠信息

注意：按下该热键时，按下的键仍会被发送


## 类型
|类型|定义|注意|
|:---|:---|:---|
|字符串|略|略|
|整数|以十进制表示的阿拉伯数字|不应包含数字外的其他字符|
|布尔值|真(True)或假(False)|该项不区分大小写|

# 🎨启动参数 
可以从命令行、快捷方式、批处理等方式以参数方式调用程序，比如
例如：

`MouseSyncClientCore.exe debug notsimulate ip 127.0.0.1`


### 服务端(MouseSyncServer.exe)
|参数|含义|
|---|---|
|debug|以调试模式启动|


### 客户端(MouseSyncClientCore.exe)
|参数|含义|
|---|---|
|debug|以调试模式启动|
|notsimulate|不模拟按键输入|
|ip|指定特定的ip地址，需要将IP地址跟在后面（忽略配置文件中的参数）|

